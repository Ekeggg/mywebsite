{% extends "helpdesk/base.html" %}
{% block title %}{{ request.title }}{% endblock %}
{% block content %}
<div class="card mb-4 shadow-sm">
  <div class="card-body">
    <h2>{{ request.title }}</h2>
    <p class="text-muted">
      {{ request.subject }} • Posted by {{ request.User.username }} on {{ request.created_at }}
    </p>
    <p>{{ request.description }}</p>
  </div>
</div>
<h4>Replies</h4>

{% for reply in request.replies.all %}
<div class="card mb-3">
  <div class="card-body">
    <p>{{ reply.message }}</p>
    <p class="text-muted">— {{ reply.responder }}, {{ reply.created_at }}</p>
  </div>
</div>
{% empty %}
  <p>No replies yet.</p>
{% endfor %}
{% if user.is_authenticated %}
  <hr>
  <h4>Add a Reply</h4>
  <form method="POST" action="{% url 'reply_request' request.id %}">
    {% csrf_token %}
    <textarea name="text" class="form-control mb-2" rows="3" placeholder="Write a reply..." required></textarea>
    <button class="btn btn-primary">Submit Reply</button>
  </form>
{% else %}
  <p><a href="{% url 'login' %}">Login</a> to post a reply</p>
{% endif %}
{% endblock %}
